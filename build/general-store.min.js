!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.GeneralStore=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";var StoreDefinition=_dereq_(13),GeneralStore={define:function(){return new StoreDefinition},DispatcherInstance:_dereq_(2),StoreDependencyMixin:_dereq_(7)};module.exports=GeneralStore},{13:13,2:2,7:7}],2:[function(_dereq_,module,exports){"use strict";var DispatcherInterface=_dereq_(3),invariant=_dereq_(6),instance=null,DispatcherInstance={get:function(){return instance},set:function(e){invariant(DispatcherInterface.isDispatcher(e)),instance=e}};module.exports=DispatcherInstance},{3:3,6:6}],3:[function(_dereq_,module,exports){"use strict";var DispatcherInterface={isDispatcher:function(t){return"object"==typeof t&&"function"==typeof t.register&&"function"==typeof t.unregister},isPayload:function(t){return null!==t&&"object"==typeof t&&"string"==typeof t.actionType}};module.exports=DispatcherInterface},{}],4:[function(_dereq_,module,exports){"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),EventHandler=_dereq_(5),uniqueID=_dereq_(15),Event=function(){function e(){_classCallCheck(this,e),this._handlers={}}return _createClass(e,[{key:"addHandler",value:function(e){var n=uniqueID();return this._handlers[n]=e,new EventHandler(this,n)}},{key:"remove",value:function(){return this._handlers={},this}},{key:"removeHandler",value:function(e){return delete this._handlers[e],this}},{key:"_runHandler",value:function(e){this._handlers.hasOwnProperty(e)&&this._handlers[e].call()}},{key:"runHandlers",value:function(){return Object.keys(this._handlers).forEach(this._runHandler.bind(this)),this}}],[{key:"runMultiple",value:function(e){e.forEach(function(e){return e.runHandlers()})}}]),e}();module.exports=Event},{15:15,5:5}],5:[function(_dereq_,module,exports){"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),EventHandler=function(){function e(n,t){_classCallCheck(this,e),this._key=t,this._instance=n}return _createClass(e,[{key:"remove",value:function(){null!==this._instance&&void 0!==this._instance&&(this._instance.removeHandler(this._key),this._instance=null)}}]),e}();module.exports=EventHandler},{}],6:[function(_dereq_,module,exports){"use strict";var invariant=function(e,n,i,r,o,t,a,d){if(!e){var f;throw f=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.")}};module.exports=invariant},{}],7:[function(_dereq_,module,exports){"use strict";function StoreDependencyMixin(e){var t=(Object.keys(e),!1);return{componentWillMount:function(){t&&setupHandlers(this)},componentWillReceiveProps:function(e){t&&hasPropsChanged(this.props,e)&&this.setState(getDependencyState(this,e,this.state,null))},componentWillUnmount:function(){t&&cleanupHandlers(this)},componentDidUpdate:function(e,n){t&&hasStateChanged(dependencies(this),n,this.state)&&this.setState(getDependencyState(this,this.props,this.state,null))},getInitialState:function(){return t=!stores(this).length,applyDependencies(this,e),getDependencyState(this,this.props,this.state,Object.keys(e))}}}var _require=(_dereq_(14),_dereq_(8)),dependencies=_require.dependencies,stores=_require.stores,_require2=_dereq_(9),cleanupHandlers=_require2.cleanupHandlers,setupHandlers=_require2.setupHandlers,_require3=_dereq_(10),applyDependencies=_require3.applyDependencies,_require4=_dereq_(11),getDependencyState=_require4.getDependencyState,_require5=_dereq_(12),hasPropsChanged=_require5.hasPropsChanged,hasStateChanged=_require5.hasStateChanged;module.exports=StoreDependencyMixin},{10:10,11:11,12:12,14:14,8:8,9:9}],8:[function(_dereq_,module,exports){"use strict";function getKey(e,n,t){return t.hasOwnProperty(e)||(t[e]=n),t[e]}var DEPENDENCIES_KEY=(_dereq_(5),_dereq_(14),"__StoreDependencyMixin-dependencies"),HANDLERS_KEY="__StoreDependencyMixin-eventHandlers",QUEUE_KEY="__StoreDependencyMixin-queue",STORES_KEY="__StoreDependencyMixin-stores",STORE_FIELDS_KEY="__StoreDependencyMixin-storeFields",StoreDependencyMixinFields={dependencies:function(e){return getKey(DEPENDENCIES_KEY,{},e)},handlers:function(e){return getKey(HANDLERS_KEY,[],e)},queue:function(e){return getKey(QUEUE_KEY,{},e)},stores:function(e){return getKey(STORES_KEY,[],e)},storeFields:function(e){return getKey(STORE_FIELDS_KEY,{},e)}};module.exports=StoreDependencyMixinFields},{14:14,5:5}],9:[function(_dereq_,module,exports){"use strict";function flushQueue(e){var r=dependencies(e),n=queue(e),t={};Object.keys(n).forEach(function(s){var i=r[s];t[s]=i.deref(e.props,e.state,i.stores),delete n[s]}),e.setState(t)}function waitForOtherStores(e,r){var n=stores(e);n.forEach(function(e){var n=e.getDispatcher();e.getID()!==r&&n.isDispatching()&&n.waitFor([e.getDispatchToken()])})}function handleStoreChange(e,r){var n=queue(e),t=0===Object.keys(n).length;storeFields(e)[r].forEach(function(e){n.hasOwnProperty(e)||(n[e]=!0)}),t&&(waitForOtherStores(e,r),flushQueue(e))}var _require=_dereq_(8),dependencies=_require.dependencies,handlers=_require.handlers,queue=_require.queue,storeFields=_require.storeFields,stores=_require.stores,StoreDependencyMixinHandlers={cleanupHandlers:function(e){for(var r=handlers(e);r.length;)r.pop().remove()},setupHandlers:function(e){var r=handlers(e),n=stores(e);n.forEach(function(n){r.push(n.addOnChange(handleStoreChange.bind(null,e,n.getID())))})}};module.exports=StoreDependencyMixinHandlers},{8:8}],10:[function(_dereq_,module,exports){"use strict";function defaultDeref(e,r,i){return i[0].get()}var StoreFacade=_dereq_(14),invariant=_dereq_(6),_require=_dereq_(8),dependencies=_require.dependencies,storeFields=_require.storeFields,stores=_require.stores,StoreDependencyMixinInitialize={applyDependencies:function(e,r){var i=dependencies(e),n=storeFields(e),t=stores(e);Object.keys(r).forEach(function(e){var s,a=r[e];a instanceof StoreFacade?(s=[a],invariant(!i.hasOwnProperty(e)),i[e]={deref:defaultDeref,stores:s}):(s=a.stores,i[e]=a),s.forEach(function(r){var i=r.getID();n.hasOwnProperty(i)||(n[i]=[],t.push(r)),n[i].push(e)})})}};module.exports=StoreDependencyMixinInitialize},{14:14,6:6,8:8}],11:[function(_dereq_,module,exports){"use strict";var _require=_dereq_(8),dependencies=_require.dependencies,StoreDependencyMixinState={getDependencyState:function(e,n,r,t){var i=dependencies(e);t=t||Object.keys(i);var d={};return t.forEach(function(e){var t=i[e],c=t.deref,s=t.stores;d[e]=c(n,r,s)}),d}};module.exports=StoreDependencyMixinState},{8:8}],12:[function(_dereq_,module,exports){"use strict";function compareKey(n,r,e){return compare(r[n],e[n])}function shallowEqual(n,r,e){if(r===e)return!0;var t;for(t in r)if(r.hasOwnProperty(t)&&(!e.hasOwnProperty(t)||!n(t,r,e)))return!1;for(t in e)if(e.hasOwnProperty(t)&&!r.hasOwnProperty(t))return!1;return!0}var compare=window.Immutable&&"function"==typeof window.Immutable.is?window.Immutable.is:function(n,r){return n===r},StoreDependencyMixinTransitions={hasPropsChanged:function(n,r){return!shallowEqual(compareKey,n,r)},hasStateChanged:function(n,r,e){return!shallowEqual(function(r,e,t){return n.hasOwnProperty(r)||compare(e[r],t[r])},r,e)}};module.exports=StoreDependencyMixinTransitions},{}],13:[function(_dereq_,module,exports){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function emptyGetter(){return null}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),DispatcherInstance=_dereq_(2),DispatcherInterface=_dereq_(3),StoreFacade=_dereq_(14),invariant=_dereq_(6),StoreDefinition=function(){function e(){_classCallCheck(this,e),this._facade=null,this._getter=null,this._responses={}}return _createClass(e,[{key:"defineGet",value:function(e){return invariant(!this.isRegistered()),invariant("function"==typeof e),this._getter=e,this}},{key:"defineResponseTo",value:function(e,t){var n=this;return invariant(!this.isRegistered()),[].concat(e).forEach(function(e){return n._setResponse(e,t)}),this}},{key:"isRegistered",value:function(){return this._facade instanceof StoreFacade}},{key:"register",value:function(e){e=e||DispatcherInstance.get(),invariant(null!==e&&"object"==typeof e),invariant(DispatcherInterface.isDispatcher(e)),invariant("function"==typeof this._getter);var t=this._facade||new StoreFacade(this._getter||emptyGetter,this._responses,e);return null===this._facade&&(this._facade=t),t}},{key:"_setResponse",value:function(e,t){invariant("string"==typeof e),invariant(!this._responses.hasOwnProperty(e)),invariant("function"==typeof t),this._responses[e]=t}}]),e}();module.exports=StoreDefinition},{14:14,2:2,3:3,6:6}],14:[function(_dereq_,module,exports){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function getNull(){return null}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Event=(_dereq_(3),_dereq_(4)),uniqueID=(_dereq_(5),_dereq_(15)),invariant=_dereq_(6),StoreFacade=function(){function e(t,n,r){_classCallCheck(this,e),this._dispatcher=r,this._getter=t,this._responses=n,this._event=new Event,this._uid=uniqueID(),this._dispatchToken=this._dispatcher.register(this._handleDispatch.bind(this))}return _createClass(e,[{key:"addOnChange",value:function(e){return invariant("function"==typeof e),this._event.addHandler(e)}},{key:"get",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this._getter.apply(null,t)}},{key:"getDispatcher",value:function(){return this._dispatcher}},{key:"getDispatchToken",value:function(){return this._dispatchToken}},{key:"getID",value:function(){return this._uid}},{key:"_handleDispatch",value:function(e){this._responses.hasOwnProperty(e.actionType)&&(this._responses[e.actionType](e.data,e.actionType,e),this.triggerChange())}},{key:"remove",value:function(){this._dispatcher.unregister(this.getDispatchToken()),this._event.remove(),this._getter=getNull,this._responses={}}},{key:"triggerChange",value:function(){return this._event.runHandlers(),this}}]),e}();module.exports=StoreFacade},{15:15,3:3,4:4,5:5,6:6}],15:[function(_dereq_,module,exports){"use strict";function uid(){return PREFIX+nextUid++}var PREFIX="uid_",nextUid=0;module.exports=uid},{}]},{},[1])(1)});